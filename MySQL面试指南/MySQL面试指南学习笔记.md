# 二、MySQL版本类问题

## 1.版本类常见问题

问题1：你之前工作中使用的是什么版本的MySQL？为什么选择这个版本？

问题2：如何决定是否要为了MySQL进行升级？如何进行升级？

问题3：最新的MySQL版本是什么？它有什么特性比较吸引你？

## 2.为什么选择某一MySQL版本

#### 知识点

* MySQL常见的发行版

  MySQL官方版本

  Percona MySQL

  MariaDB

* 各个发行版本之间的区别和优缺点

  #### 基于服务器特性

  |           MySQL            |   Percona MySQL    |  MariaDB   |
  | :------------------------: | :----------------: | :--------: |
  |            开源            |        开源        |    开源    |
  |         支持分区表         |     支持分区表     | 支持分区表 |
  |           InnoDB           |       XtraDB       |   XtraDB   |
  | 企业版监控工具社区版不提供 | Percon Monitor工具 |   Monyog   |
  #### 基于高可用特性

  |     MySQL      | Percona MySQL  |             MariaDB              |
  | :------------: | :------------: | :------------------------------: |
  | 基于日志点复制 | 基于日志点复制 |          基于日志点复制          |
  |  基于Gtid复制  |  基于Gtid复制  | 基于Gtid复制,但Gtid同MySQL不兼容 |
  |      MGR       |    MGR&PXC     |          Galera Cluster          |
  |  MySQL Router  |   Proxy SQL    |             MaxScale             |
  #### 安全特性

  |                 MySQL                 |             Percona MySQL             |         MariaDB         |
  | :-----------------------------------: | :-----------------------------------: | :---------------------: |
  |             企业版防火墙              |           ProxySQL FireWall           |    MaxScale FireWall    |
  |            企业版用户审计             |               审计日志                |        审计日志         |
  |           用户密码生命周期            |           用户密码生命周期            |            -            |
  | sha256_password caching_sha2_password | sha256_password caching_sha2_password | ed25519 sha256_password |

  #### 开发及管理

  |      MySQL      |  Percona MySQL  |     MariaDB      |
  | :-------------: | :-------------: | :--------------: |
  | 窗口函数（8.0） | 窗口函数（8.0） | 窗口函数（10.2） |
  |        -        |        -        | 支持基于日志回滚 |
  |        -        |        -        |        -         |
  | Super read_only | Super read_only |        -         |

  问题1：你之前工作中使用的是什么版本的MySQL？为什么选择这个版本？

  当前公司是使用什么版本的MySQL，我们之前使用的是什么版本，版本之间有啥差异

## 3.如何对MySQL进行升级

#### 在对MySQL进行升级前要考虑什么？

1. 升级可以给业务带来的益处
   1. 是否可以解决业务上某一方面的痛点
      1. MySQL5.6升级到5.7，大幅度减小主从延迟时间
      2. MySQL8对Json部分复制的支持
   2. 是否可以解决运维上某一方面的痛点
2. 升级可能对业务带来的影响
   1. 对原业务程序的支持是否有影响
   2. 对原业务程序的性能是否有影响
3. 数据库升级方案的制定
   1. 评估受影响的业务系统
   2. 升级的详细步骤
   3. 升级后的数据库环境检查
   4. 升级后的业务检查
4. 升级失败的回滚方案
   1. 升级失败回滚的步骤
   2. 回滚后的业务检查

#### MySQL升级的步骤

1. 对待升级数据库进行备份
2. 升级Slave服务器版本
3. 手动进行主从切换
4. 升级Master服务器版本
5. 升级完成后进行业务检查

问题2：如何决定是否要为了MySQL进行升级？如何进行升级？

不能为了升级而升级，对数据库的升级一定要给我们的业务或者管理带来一些有利的好处

## 4.最新的MySQL版本及其新特性

#### MySQL8.0版本主要的新特性

|             服务器功能新特性             |
| :--------------------------------------: |
| 所有元数据使用InnoDB引擎存储，无frm文件  |
|   系统表采用InnoDB存储并采用独立表空间   |
| 支持定义资源管理组（目前仅支持CPU资源）  |
| 支持不可见索引和降序索引，支持直方图优化 |
|               支持窗口函数               |
|        支持在线修改全局参数持久化        |

|           InnoDB新特性            |
| :-------------------------------: |
|    InnoDB DDL语句支持原子操作     |
|      支持在线修改UNDO表空间       |
| 新增管理视图用于监控InnoDB表状态  |
| 新增Innodb_dedicated_server配置项 |

问题3：最新的MySQL版本是什么？它有什么特性比较吸引你？